### 1. Description of Mutect2 Tumor Only Submodule
The Mutect2 Tumor Only submodule is a component of the MuTect2 tool, which is used for somatic variant calling in tumor samples using next-generation sequencing data. The Tumor Only submodule specifically focuses on analyzing tumor-only sequencing data, where there is no corresponding normal sample available for comparison.

The purpose of the Mutect2 Tumor Only submodule is to identify somatic mutations, which are genetic alterations that are present only in the tumor cells and not in the normal cells. By analyzing the tumor sequencing data alone, the submodule aims to detect these somatic mutations and distinguish them from germline variants or sequencing artifacts.

### 2. Description of Interfaces and Dependencies
--> rule Mutect2_tumor_only:

This rule provides a standardized and reproducible way to perform somatic variant calling specifically on tumor samples without the availability of corresponding normal samples.
The rule aims to identify somatic mutations, which are genetic alterations that are present only in the tumor cells and not in the normal cells. By using the MuTect2 tool, the rule leverages its algorithm and strategies to detect somatic mutations from tumor-only sequencing data.The rule also likely includes steps to assess the quality of the sequencing data and apply appropriate filters to remove potential false positives or artifacts. This helps to increase the confidence in the identified somatic mutations and reduce the number of false-positive calls.

- Specifications of Input Files

these inputs is specify the location and names of the tumor BAM and BAI files required for the Mutect2 variant calling analysis. These files contain the aligned sequencing data for the tumor sample, which serves as the primary input for the variant calling process.

```
        tumor_bam = "bam/{tsample}.nodup.recal.bam" if config["remove_duplicates"] == True else "bam/{tsample}.recal.bam",
        tumor_bai = "bam/{tsample}.nodup.recal.bam.bai" if config["remove_duplicates"] == True else "bam/{tsample}.recal.bam.bai",
```
- Ouput Files

-> the VCF file contains the called variants identified in the tumor sample using the tumor-only variant calling approach. 
-> The index file, with a ".tbi" extension, allows for quick and efficient querying of specific regions within the VCF file. The index file enables faster access to the VCF data, especially for region-specific analyses or downstream processing.
-> Stat file contains various statistical metrics and summary information related to the variant calling process and the called variants. It provides insights into the quality and characteristics of the variant calls made by MuTect2.

```
        VCF   = temp("Mutect2_T_tmp/{tsample}_tumor_only_T_ON_{interval}.vcf.gz"),
        INDEX = temp("Mutect2_T_tmp/{tsample}_tumor_only_T_ON_{interval}.vcf.gz.tbi"),
        STATS = temp("Mutect2_T_tmp/{tsample}_tumor_only_T_ON_{interval}.vcf.gz.stats")
```
--> concatenate_mutect2_tumor_only

The "concatenate_mutect2_tumor_only" rule, based on its name, is likely designed to concatenate or merge the output VCF files generated by the Mutect2 tumor-only variant calling analysis. This rule helps to consolidate the results from multiple tumor samples analyzed individually using the Mutect2 tool.

- input files :

This input file represents a list of VCF (Variant Call Format) files that are generated by the Mutect2 variant calling analysis for tumor-only samples. 
```
        vcfs = expand("Mutect2_T_tmp/{{tsample}}_tumor_only_T_ON_{mutect_interval}.vcf.gz", mutect_interval=mutect_intervals)
```
- output files :
concatened vcf : The file contains the merged or concatenated variant calls from multiple tumor samples generated by the Mutect2 tumor-only variant calling analysis.
vcf_liste :  
```
        concatened_vcf = temp("Mutect2_T/{tsample}_tumor_only_T.vcf.gz"),
        vcf_liste      = temp("mutect2_T_tmp_list/{tsample}_tumor_only_T_mutect2_tmp.list"),
```
--> rule concatenate_mutect2_tumor_only_stats:

The "concatenate_mutect2_tumor_only_stats" rule is designed to concatenate or merge the statistics files generated by the Mutect2 tumor-only variant calling analysis. This rule helps to consolidate the statistical metrics and summary information from multiple tumor samples analyzed individually using Mutect2.

- input files :
This input file represents a list of statistics files generated by the Mutect2 variant calling analysis for tumor-only samples.
 the input vcfs will contain a list of statistics file paths corresponding to the tumor-only variant calling results for the specified tumor samples and genomic intervals.
```
      vcfs = expand("Mutect2_T_tmp/{{tsample}}_tumor_only_T_ON_{mutect_interval}.vcf.gz.stats", mutect_interval=mutect_intervals)
```
- output files :
concatened_stats: * The file contains the merged or concatenated statistical metrics and summary information from multiple tumor samples generated by the Mutect2 tumor-only variant calling analysis. 

stat_liste:  This list file contains the paths or names of the input statistics files that were concatenated. The {tsample} placeholder represents the name or identifier of each tumor sample. The list file serves as a record or reference to track the individual statistics files used in the concatenation process.

```
        concatened_stats = temp("Mutect2_T/{tsample}_tumor_only_T.vcf.gz.stats"),
        stat_liste       = temp("mutect2_T_tmp_list/{tsample}_tumor_only_T_mutect2_tmp_stats.list"),
```

--> rule filter_mutect_calls_tumor_only :

The "filter_mutect_calls_tumor_only" rule is designed to apply filtering criteria to the variant calls generated by the Mutect2 tumor-only variant calling analysis. This rule helps to filter and select high-confidence variants based on specific quality and annotation thresholds.

- input files :

These input files are essential for applying the filtering criteria in the rule, as they provide the initial variant calls, associated statistics, and contamination information necessary for the filtering process.

-> Mutect2_vcf: The input VCF file from the Mutect2 tumor-only variant calling analysis. This file contains the initial variant calls generated by Mutect2 for the tumor-only samples. 

-> Mutect2_stats: The statistics file associated with the Mutect2 VCF file ,  This file contains various statistical metrics and summary information related to the variant calling process.

-> contamination_table: The contamination table file used for estimating cross-sample contamination. This file likely contains information or metrics related to the presence of contamination in the tumor sample. 
```
        Mutect2_vcf = "Mutect2_T/{tsample}_tumor_only_T.vcf.gz",
        Mutect2_stats = "Mutect2_T/{tsample}_tumor_only_T.vcf.gz.stats",
        contamination_table = "cross_sample_contamination/{tsample}_calculatecontamination.table",
```
- output files :
-> VCF: . The file contains the variant calls that have passed the filtering criteria applied in the rule. The VCF file is compressed in the gzip format (".vcf.gz").

-> INDEX:  The index file is used for quick retrieval of specific variants from the VCF file. 

```
        VCF   = temp("Mutect2_T/{tsample}_tumor_only_filtered_T.vcf.gz"),
        INDEX = temp("Mutect2_T/{tsample}_tumor_only_filtered_T.vcf.gz.tbi")
```

--> rule Filter_By_Orientation_Bias_tumor_only:

The "Filter_By_Orientation_Bias_tumor_only" rule is designed to filter variant calls from the Mutect2 tumor-only analysis based on orientation bias. Orientation bias refers to the tendency of certain sequencing technologies to produce systematic errors in the form of strand-specific biases.

- input files :
Mutect2_vcf:This file contains the variant calls that have passed the filtering criteria applied in the previous step. 

Mutect2_idx: This file is used for efficient retrieval of specific variants from the VCF file. 

pre_adapter_detail_metrics: This file likely contains detailed metrics and information about the sequencing artifacts, including orientation bias. 
```
        Mutect2_vcf = "Mutect2_T/{tsample}_tumor_only_filtered_T.vcf.gz",
        Mutect2_idx = "Mutect2_T/{tsample}_tumor_only_filtered_T.vcf.gz.tbi",
        pre_adapter_detail_metrics = "collect_Sequencing_Artifact_Metrics/{tsample}_artifact.pre_adapter_detail_metrics.txt"
```
- output files :
filtered_vcf: The file contains the variant calls that have undergone additional filtering based on orientation bias. The VCF file is compressed in the gzip format (".vcf.gz").

filtered_vcf_index:The index file is used for quick retrieval of specific variants from the VCF file. 

```
        filtered_vcf       = "Mutect2_T/{tsample}_tumor_only_twicefiltered_T.vcf.gz",
        filtered_vcf_index = "Mutect2_T/{tsample}_tumor_only_twicefiltered_T.vcf.gz.tbi",
```
### 3. Issues and TODO
