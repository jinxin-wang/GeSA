### 1. Description of Mutect2 Tumor Only vs Panel of Normals Submodule
The Mutect2 algorithm is a widely used tool for the identification of somatic mutations in cancer genomes through the analysis of DNA sequencing data. It is part of the Genome Analysis Toolkit (GATK), developed by the Broad Institute.

The "Tumor Only" and "Panel of Normals" (PON) submodules within Mutect2 are designed to improve the accuracy of mutation calling by leveraging different sources of information.

By combining the information from the Tumor Only and Panel of Normals submodules, Mutect2 aims to improve the accuracy of mutation calling in cancer genomes. The Tumor Only submodule detects somatic mutations specific to the tumor sample, while the Panel of Normals submodule helps filter out common germline variants and technical artifacts that may be present in the tumor sample but not relevant to the cancer biology.


### 2. Description of Interfaces and Dependencies
rule Mutect2_tumor_only_pon:

The rule "Mutect2_tumor_only_pon" likely involves running the MuTect2 variant calling tool on tumor samples using a Panel of Normals (PoN). The purpose of this rule is to identify somatic mutations specific to the tumor samples while leveraging the information from the PoN to filter out potential germline variants or technical artifacts.

- Specifications of Input Files

-> tumor bam :This input file represents the aligned sequence data (in BAM format) for the tumor sample being analyzed. The actual file path depends on the value of config["remove_duplicates"]. If remove_duplicates is set to True, the file path will be "bam/{tsample}.nodup.recal.bam", indicating that the duplicate reads have been removed from the BAM file. If remove_duplicates is False, the file path will be "bam/{tsample}.recal.bam", indicating that the BAM file includes duplicate reads.
-> tumor bai :This input file represents the index file (BAI) associated with the tumor BAM file. The BAI file is used for efficient access and querying of the BAM file. Similar to tumor_bam, the actual file path depends on the value of config["remove_duplicates"]. If remove_duplicates is True, the file path will be "bam/{tsample}.nodup.recal.bam.bai". If remove_duplicates is False, the file path will be "bam/{tsample}.recal.bam.bai".
-> panel of normal : The Panel of Normals (PoN) VCF file. It is specified as "PoN/{panel_of_normal}.vcf", where {panel_of_normal} represents the name or identifier of the PoN file.
```
        tumor_bam = "bam/{tsample}.nodup.recal.bam" if config["remove_duplicates"] == True else "bam/{tsample}.recal.bam",
        tumor_bai = "bam/{tsample}.nodup.recal.bam.bai" if config["remove_duplicates"] == True else "bam/{tsample}.recal.bam.bai",
        panel_of_normal = "PoN/{panel_of_normal}.vcf",
```
- Ouput Files

These output files are generated as a result of the Mutect2 tumor-only PoN analysis and provide the VCF variants, associated index, and statistical metrics specific to the tumor sample and the applied interval.

VCF: The file contains the variant calls specific to the tumor sample, considering the Panel of Normals (PoN) and the specified interval. The {tsample} placeholder represents the name or identifier of the tumor sample, {panel_of_normal} represents the name or identifier of the PoN file, and {interval} represents the specific interval used for variant calling.

INDEX: The index file enables efficient querying and retrieval of specific variants from the VCF file. 

STATS: The statistics file likely contains various statistical metrics and summary information related to the variant calling process. 

```
        VCF   = temp("Mutect2_Tp_tmp/{tsample}_PON_{panel_of_normal}_Tp_ON_{interval}.vcf.gz"),
        INDEX = temp("Mutect2_Tp_tmp/{tsample}_PON_{panel_of_normal}_Tp_ON_{interval}.vcf.gz.tbi"),
        STATS = temp("Mutect2_Tp_tmp/{tsample}_PON_{panel_of_normal}_Tp_ON_{interval}.vcf.gz.stats"),
```

--> rule concatenate_mutect2_tumor_only_pon:

The "concatenate_mutect2_tumor_only_pon" rule likely aims to combine or concatenate multiple Mutect2 tumor-only PoN VCF files into a single consolidated file. By merging the individual PoN VCF files, the resulting file can be used as a comprehensive Panel of Normals for subsequent variant calling analyses

- input files :

These input files are required for the concatenation or merging of multiple Mutect2 tumor-only PoN VCF files into a consolidated PoN. The VCF files contain the variant calls specific to each tumor sample and interval, while the panel_of_normal file represents the reference Panel of Normals used in the analysis.

vcfs: This input parameter represents a list of VCF (Variant Call Format) files generated by the Mutect2 tumor-only PoN analysis. 
panel_of_normal: This input parameter represents the Panel of Normals (PoN) VCF file used in the Mutect2 tumor-only PoN analysis.

```
        vcfs = expand("Mutect2_Tp_tmp/{{tsample}}_PON_{{panel_of_normal}}_Tp_ON_{mutect_interval}.vcf.gz", mutect_interval=mutect_intervals),
        panel_of_normal = "PoN/{panel_of_normal}.vcf"
```
- output files :
concatened_vcf: the file is generated by the concatenation of multiple Mutect2 tumor-only PoN VCF files. The file contains the consolidated variant calls from the individual PoN VCF files. 
vcf_liste: The list file is useful for tracking the input files used in the concatenation process. 

```
        concatened_vcf = temp("Mutect2_Tp/{tsample}_PON_{panel_of_normal}_Tp.vcf.gz"),
        vcf_liste      = temp("mutect2_Tp_tmp_list/{tsample}_PON_{panel_of_normal}_Tp_mutect2_tmp.list")
```

--> rule concatenate_mutect2_tumor_only_pon_stats:
The "concatenate_mutect2_tumor_only_pon_stats" rule likely aims to concatenate and consolidate the statistics or metrics files generated by the Mutect2 tumor-only Panel of Normals (PoN) analysis. By merging the individual statistics files, the resulting file can provide a comprehensive summary of the PoN analysis metrics.

- input files :

vcfs: This input parameter represents a list of statistics or metrics files generated by the Mutect2 tumor-only PoN analysis. 
panel_of_normal: This input parameter represents the Panel of Normals (PoN) VCF file used in the Mutect2 tumor-only PoN analysis. 

```
        vcfs = expand("Mutect2_Tp_tmp/{{tsample}}_PON_{{panel_of_normal}}_Tp_ON_{mutect_interval}.vcf.gz.stats", mutect_interval=mutect_intervals),
        panel_of_normal = "PoN/{panel_of_normal}.vcf"
```
- output files :

concatened_stats: The file contains the merged metrics and summary information from the individual statistics files.
stat_liste: The list file is useful for tracking the input files used in the concatenation process. 

```
        concatened_stats = temp("Mutect2_Tp/{tsample}_PON_{panel_of_normal}_Tp.vcf.gz.stats"),
        stat_liste       = temp("mutect2_Tp_tmp_list/{tsample}_PON_{panel_of_normal}_Tp_mutect2_tmp_stats.list")
```

--> rule filter_mutect_calls_tumor_only_pon:

The "filter_mutect_calls_tumor_only_pon" rule likely aims to filter and refine the variant calls generated by the Mutect2 tumor-only Panel of Normals (PoN) analysis. This rule applies additional filters and criteria to improve the quality and reliability of the variant calls.

- input files :
These input files are used as inputs for filtering and refining the variant calls generated by the Mutect2 tumor-only PoN analysis. The Mutect2 VCF file contains the variant calls, the Mutect2 statistics file provides additional information and metrics, the contamination table is used for contamination estimation, and the panel_of_normal file represents the reference Panel of Normals used in the analysis.

Mutect2_vcf: This input parameter represents the Mutect2 VCF file generated by the tumor-only Panel of Normals (PoN) analysis.

Mutect2_stats: This input parameter represents the Mutect2 statistics file generated by the tumor-only PoN analysis. 

contamination_table: This input parameter represents the contamination table file used in the analysis. The purpose is to estimate and correct for sample contamination.Sample contamination refers to the presence of genetic material from one sample in another sample, which can lead to erroneous variant calls. 

panel_of_normal: This input parameter represents the Panel of Normals (PoN) VCF file used in the tumor-only PoN analysis.The purpose of using a Panel of Normals is to reduce false-positive variant calls by filtering out variants that are common in the general population or are present in the normal samples. By comparing the variant calls from the tumor sample with the variants in the Panel of Normals, the rule can identify and remove common germline variants, focusing on somatic variants that are more likely to be specific to the tumor.

```
        Mutect2_vcf = "Mutect2_Tp/{tsample}_PON_{panel_of_normal}_Tp.vcf.gz",
        Mutect2_stats = "Mutect2_Tp/{tsample}_PON_{panel_of_normal}_Tp.vcf.gz.stats",
        contamination_table = "cross_sample_contamination/{tsample}_calculatecontamination.table" ,
        panel_of_normal = "PoN/{panel_of_normal}.vcf"
```
- output files :

These output files contain the filtered and refined variant calls specific to the tumor-only Panel of Normals analysis, which have undergone additional filtering steps and criteria to improve the accuracy and reliability of the final variant calls.
VCF: This output file represents the filtered and refined VCF (Variant Call Format) file generated by the rule.
INDEX: This output file represents the index file associated with the filtered VCF file. The index file, often with a ".tbi" extension, allows for efficient querying and retrieval of specific variants from the VCF file. 
```
        VCF   = temp("Mutect2_Tp/{tsample}_PON_{panel_of_normal}_filtered_Tp.vcf.gz"),
        INDEX = temp("Mutect2_Tp/{tsample}_PON_{panel_of_normal}_filtered_Tp.vcf.gz.tbi"),
```

--> rule Filter_By_Orientation_Bias_tumor_only_pon:

The "Filter_By_Orientation_Bias_tumor_only_pon" rule is designed to filter a VCF (Variant Call Format) file specifically for orientation bias related to OxoG (oxidative damage) and FFPE (formalin-fixed paraffin-embedded) samples. This rule is applied to the VCF file generated by the Mutect tumor-only analysis with a Panel of Normals (PoN).

The purpose of this rule is to identify and filter out variants that are likely to be caused by sequencing artifacts related to orientation bias. Orientation bias refers to the preferential misincorporation or misalignment of bases during sequencing, which can introduce systematic errors and result in false-positive variant calls. This bias is particularly relevant in OxoG and FFPE samples, which are known to exhibit increased oxidation or DNA damage.

- input files :

Mutect2_vcf: This input file represents the VCF (Variant Call Format) file generated by the Mutect2 analysis with a tumor-only Panel of Normals (PoN). 
pre_adapter_detail_metrics: This input file represents the pre-adapter detail metrics file obtained from the "collect_Sequencing_Artifact_Metrics" step.

```
        Mutect2_vcf = "Mutect2_Tp/{tsample}_PON_{panel_of_normal}_filtered_Tp.vcf.gz",
        pre_adapter_detail_metrics = "collect_Sequencing_Artifact_Metrics/{tsample}_artifact.pre_adapter_detail_metrics.txt",
```
- output files :

These output files contain the filtered variant calls specifically for the tumor-only Panel of Normals analysis after the orientation bias filtering step. The twice-filtered VCF file represents the refined and reliable set of variants, free from orientation bias artifacts.

filtered_vcf: This output file represents the filtered VCF (Variant Call Format) file after applying the orientation bias filtering step.
filtered_vcf_index: This output file represents the index file associated with the filtered VCF file. The index file, often with a ".tbi" extension, allows for efficient querying and retrieval of specific variants from the VCF file. 
```
        filtered_vcf       = "Mutect2_Tp/{tsample}_PON_{panel_of_normal}_twicefiltered_Tp.vcf.gz",
        filtered_vcf_index = "Mutect2_Tp/{tsample}_PON_{panel_of_normal}_twicefiltered_Tp.vcf.gz.tbi",
```
- Packages and Versions

### 3. Issues and TODO
